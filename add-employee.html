<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Add Employee</title>
  <link rel="stylesheet" href="style.css">
  <link rel="icon" href="/ncpicon.ico" type="image/x-icon">
  <link rel="shortcut icon" href="/ncpicon.ico" type="image/x-icon">
</head>
<body>
<!-- Branding -->
<div style="position: fixed; top: 20px; left: 30px; z-index: 10;">
  <div class="brand">
    <div class="brand-circle">
      <img src="logo.png" alt="NCP Logo">
    </div>
    <span>NCP Bookkeeping</span>
  </div>
</div>

<div class="container">
  <h1>Add Employee</h1>

  <input type="text" id="name" placeholder="Full Name">
  <input type="text" id="contact" placeholder="Contact Number">
  <input type="email" id="email" placeholder="Google Email">

  <div class="leave-options">
    <button type="button" class="leave-btn" onclick="selectType(this, 'Full-Time')">
      FULL TIME
    </button>
    <button type="button" class="leave-btn" onclick="selectType(this, 'Part-Time')">
      PART TIME
    </button>
  </div>

  <button class="primary-btn" onclick="submitEmployee()">Create Employee</button>
  <button class="secondary-btn" onclick="goBack()" style="margin-top: 10px;">
    Back
  </button>
</div>

<script>
/* =====================
   CONFIG
===================== */
const SCRIPT_URL =
  "https://script.google.com/macros/s/AKfycbz4zMRShI6IwL7ehez3Q9VX_ysMQb3Otv__59tgoe5-91zfEN1THvLSJjty_TCN24Wp/exec";

let employeeType = "";

/* =====================
   UI HANDLERS
===================== */
function selectType(btn, type) {
  employeeType = type;
  document.querySelectorAll(".leave-btn")
    .forEach(b => b.classList.remove("active"));
  btn.classList.add("active");
}

function goBack() {
  if (document.referrer) {
    window.history.back();
  } else {
    window.location.href = "employees.html";
  }
}

/* =====================
   SUBMIT EMPLOYEE
===================== */
let creatingEmployee = false;

function submitEmployee() {
  if (creatingEmployee) return;

  const name = document.getElementById("name").value.trim();
  const contact = document.getElementById("contact").value.trim();
  const email = document.getElementById("email").value.trim();

  if (!name || !email || !employeeType) {
    alert("Please complete all required fields.");
    return;
  }

  const btn = document.querySelector(".primary-btn");

  // üîí Lock UI
  creatingEmployee = true;
  btn.disabled = true;
  btn.innerText = "Creating‚Ä¶";
  btn.style.opacity = "0.85";

  const data = new URLSearchParams({
    action: "addEmployee",
    name,
    contact,
    email,
    employeeType
  });

  fetch(SCRIPT_URL, {
    method: "POST",
    body: data
  })
    .then(res => res.json())
    .then(res => {
      if (!res.success) {
        throw new Error(res.message || "Failed to add employee");
      }

      // ‚úÖ Success feedback
      btn.innerText = "Employee Created ‚úì";
      btn.style.background = "#22c55e";
      btn.style.opacity = "1";

      setTimeout(() => {
        window.location.href = "admin-dashboard.html";
      }, 800);
    })
    .catch(err => {
      alert(err.message);

      // üîÅ Reset UI
      creatingEmployee = false;
      btn.disabled = false;
      btn.innerText = "Create Employee";
      btn.style.opacity = "1";
    });
}
</script>

</body>
</html>
